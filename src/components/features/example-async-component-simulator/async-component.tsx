import { delay } from "@/lib/utils/utils";
import { PropsWithChildren } from "react";

interface AsyncComponentProps extends PropsWithChildren {
	/** ì»´í¬ë„ŒíŠ¸ ë¡œë”©ì„ ìœ„í•œ ì§€ì—° ì‹œê°„ (ë°€ë¦¬ì´ˆ) */
	delayMs?: number;
	/** ì»´í¬ë„ŒíŠ¸ë¥¼ ì‹ë³„í•˜ê¸° ìœ„í•œ ì´ë¦„ */
	name?: string;
}

/**
ë¹„ë™ê¸° ë¡œë”© ì‹œë®¬ë ˆì´ì…˜:
ì‹¤ì œ ë°ì´í„° í˜ì¹­ì´ë‚˜ ë¬´ê±°ìš´ ì»´í¬ë„ŒíŠ¸ ë¡œë”©ê³¼ ê°™ì€, ì‹¤ì œ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ë°œìƒí•  ìˆ˜ ìˆëŠ” ì§€ì—° ìƒí™©ì„ ì¸ìœ„ì ìœ¼ë¡œ ì‹œë®¬ë ˆì´ì…˜í•©ë‹ˆë‹¤.
React Suspense í…ŒìŠ¤íŠ¸ í™˜ê²½ ì œê³µ:
Suspenseì™€ fallback UIê°€ ì–´ë–»ê²Œ ì‘ë™í•˜ëŠ”ì§€ ê°œë°œ ê³¼ì •ì—ì„œ ì‰½ê²Œ í…ŒìŠ¤íŠ¸í•˜ê³  ê´€ì°°í•  ìˆ˜ ìˆê²Œ í•´ì¤ë‹ˆë‹¤.
ì ì§„ì  ë¡œë”© íŒ¨í„´ ì‹œê°í™”:
ìŠ¤íŠ¸ë¦¬ë°ê³¼ ì ì§„ì  ë¡œë”©ì´ ì‚¬ìš©ì ê²½í—˜ì— ì–´ë–¤ ì˜í–¥ì„ ë¯¸ì¹˜ëŠ”ì§€ ì‹œê°ì ìœ¼ë¡œ í™•ì¸í•  ìˆ˜ ìˆê²Œ í•©ë‹ˆë‹¤.
 AsyncComponentëŠ” ê°œë°œ ë‹¨ê³„ì—ì„œ ë¹„ë™ê¸° ë¡œë”© íŒ¨í„´ì„ í…ŒìŠ¤íŠ¸í•˜ê³  ìµœì í™”í•˜ê¸° ìœ„í•œ ë„êµ¬ë¡œ, ìš´ì˜ í™˜ê²½ì—ì„œëŠ” ê¸°ëŠ¥ì ìœ¼ë¡œ íˆ¬ëª…í•œ ë˜í¼ ì—­í• ë§Œ í•©ë‹ˆë‹¤.
 */
export async function AsyncComponent({
	children,
	delayMs = 0,
	name = "unnamed component",
}: AsyncComponentProps) {
	// ê°œë°œ í™˜ê²½ì—ì„œ ë¡œë”© ì§€ì—°ì„ ì‹œë®¬ë ˆì´ì…˜í•©ë‹ˆë‹¤ (ìµœì†Œ 300ms ~ ìµœëŒ€ ì§€ì •ëœ ì‹œê°„)

	if (process.env.NODE_ENV === "development" && delayMs > 0) {
		console.log(`ğŸ”„ '${name}'ì´(ê°€) ë¡œë”© ì¤‘... (${delayMs}ms)`);
		await delay(delayMs);
		console.log(`âœ… '${name}'ì´(ê°€) ë¡œë“œë¨`);
	}

	return <>{children}</>;
}
